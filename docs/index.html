<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Simulation and Likelihood Calculation of Phylogenetic Comparative Models • PCMBase</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Simulation and Likelihood Calculation of Phylogenetic Comparative Models">
<meta property="og:description" content="Phylogenetic comparative methods represent models of continuous trait 
  data associated with the tips of a phylogenetic tree. Examples of such models 
  are Gaussian continuous time branching stochastic processes such as Brownian 
  motion (BM) and Ornstein-Uhlenbeck (OU) processes, which regard the data at the 
  tips of the tree as an observed (final) state of a Markov process starting from 
  an initial state at the root and evolving along the branches of the tree. The 
  PCMBase R package provides a general framework for manipulating such models. 
  This framework consists of an application programming interface for specifying 
  data and model parameters, and efficient algorithms for simulating trait evolution 
  under a model and calculating the likelihood of model parameters for an assumed
  model and trait data. The package implements a growing collection of models, 
  which currently includes BM, OU, BM/OU with jumps, two-speed OU as well as mixed 
  Gaussian models, in which different types of the above models can be associated 
  with different branches of the tree. The PCMBase package is limited to 
  trait-simulation and likelihood calculation of (mixed) Gaussian phylogenetic 
  models. The PCMFit package provides functionality for inference of 
  these models to tree and trait data. The package web-site 
  &lt;https://venelin.github.io/PCMBase/&gt;
  provides access to the documentation and other resources. ">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-129563006-3"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129563006-3');
</script>
</head>
<body>
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">PCMBase</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.2.12</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="articles/PCMBase.html">Get started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/PCMParam.html">The PCMBase Parametrization API</a>
    </li>
    <li>
      <a href="articles/PCMTracePruning.html">Tracing the likelihood calculation of a Gaussian model</a>
    </li>
    <li>
      <a href="articles/PCMCreateModel.html">Creating a Custom Model in the PCMBase Framework</a>
    </li>
  </ul>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li>
  <a href="news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">


<div id="pcmbase--simulation-and-likelihood-calculation-of-phylogenetic-comparative-methods" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#pcmbase--simulation-and-likelihood-calculation-of-phylogenetic-comparative-methods" class="anchor"></a>PCMBase : Simulation and likelihood calculation of phylogenetic comparative methods</h1></div>
<p>Phylogenetic comparative methods represent models of continuous trait data associated with the tips of a phylogenetic tree. Examples of such models are Gaussian continuous time branching stochastic processes such as Brownian motion (BM) and Ornstein-Uhlenbeck (OU) processes, which regard the data at the tips of the tree as an observed (final) state of a Markov process starting from an initial state at the root and evolving along the branches of the tree. The PCMBase R package provides a general framework for manipulating such models. This framework consists of an application programming interface for specifying data and model parameters, and efficient algorithms for simulating trait evolution under a model and calculating the likelihood of model parameters for an assumed model and trait data. The package implements a growing collection of models, which currently includes BM, OU, BM/OU with jumps, two-speed OU as well as mixed Gaussian models, in which different types of the above models can be associated with different branches of the tree. Note that the PCMBase package does not implement model inference. Due to the enormous variety of models and possible model inference methods, this functionality is delegated to other packages that, taking advantage of PCMBase’s fast likelihood calculation, can implement maximum likelihood (ML) or Bayesian inference methods. For example, the <a href="https://venelin.github.io/PCMFit/">PCMFit package</a> provides heuristic-based ML fit of (mixed) Gaussian phylogenetic models (Mitov, Bartoszek, and Stadler 2019).</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<div id="an-optional-but-highly-recommended-dependency" class="section level3">
<h3 class="hasAnchor">
<a href="#an-optional-but-highly-recommended-dependency" class="anchor"></a>An optional but highly recommended dependency</h3>
<p>The function <code>PCMTreePlot</code> in the package is implemented based on the R-package ggtree, which is not on CRAN. It is highly recommended to install this package in order to visualize trees with colored parts corresponding to different evolutionary regimes. If ggtree is not installed, the package will fail to run examples and generate the vignettes. At the time of writing this documentation, ggtree can be installed from bioconductor through the following code (if that does not work, check the <a href="https://guangchuangyu.github.io/software/ggtree/">ggtree home page</a>):</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="cf">if</span> (<span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/ns-load.html">requireNamespace</a></span>(<span class="st">"BiocManager"</span>, <span class="dt">quietly =</span> <span class="ot">TRUE</span>))</span>
<span id="cb1-2"><a href="#cb1-2"></a>    <span class="kw"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"BiocManager"</span>)</span>
<span id="cb1-3"><a href="#cb1-3"></a>BiocManager<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/BiocManager/man/install.html">install</a></span>(<span class="st">"ggtree"</span>, <span class="dt">version =</span> <span class="st">"3.8"</span>)</span></code></pre></div>
</div>
<div id="installing-pcmbase-from-cran" class="section level3">
<h3 class="hasAnchor">
<a href="#installing-pcmbase-from-cran" class="anchor"></a>Installing PCMBase from CRAN</h3>
<p>A stable but possibly old version of PCMBase is available on CRAN and can be installed with this command:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"PCMBase"</span>)</span></code></pre></div>
</div>
<div id="github" class="section level3">
<h3 class="hasAnchor">
<a href="#github" class="anchor"></a>Github</h3>
<p>The newest but possibly less stable and tested version of the package can be installed using:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>devtools<span class="op">::</span><span class="kw"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span>(<span class="st">"venelin/PCMBase"</span>)</span></code></pre></div>
</div>
</div>
<div id="resources" class="section level2">
<h2 class="hasAnchor">
<a href="#resources" class="anchor"></a>Resources</h2>
<p>The user guides and technical reference for the library are available from the <a href="https://venelin.github.io/PCMBase/">PCMBase web-page</a>.</p>
<ul>
<li>The <a href="https://venelin.github.io/PCMBase/articles/PCMBase.html">Getting started</a> guide</li>
<li>The <a href="https://venelin.github.io/PCMBase/articles/PCMParam.html">PCMBase parameterizations</a> guide</li>
<li>The <a href="https://venelin.github.io/PCMBase/articles/PCMTracePruning.html">Tracing the likelihood calculation of a Gaussian mode</a> guide</li>
<li>The <a href="https://venelin.github.io/PCMBase/articles/PCMCreateModel.html">Creating a Custom Model in the PCMBase Framework</a> guide</li>
</ul>
<p>The research article “Fast likelihood calculation for multivariate Gaussian phylogenetic models with shifts”, published in <em>Theoretical Population Biology</em> provides a thorough description of the likelihood calculation algorithm currently implemented in PCMBase. Appendix A of this article gives an overview of the modular structure and the features of the package.</p>
<p>The PCMBase source code is located in the <a href="https://github.com/venelin/PCMBase">PCMBase github repository</a>.</p>
<p>Feature requests, bugs, etc can be reported in the <a href="https://github.com/venelin/PCMBase/issues">PCMBase issues list</a>.</p>
</div>
</div>
<div id="citing-pcmbase" class="section level1">
<h1 class="hasAnchor">
<a href="#citing-pcmbase" class="anchor"></a>Citing PCMBase</h1>
<p>To give credit to the PCMBase package in a publication, please cite the following article:</p>
<p>Mitov, V., Bartoszek, K., Asimomitis, G., &amp; Stadler, T. (2019). Fast likelihood calculation for multivariate Gaussian phylogenetic models with shifts. Theor. Popul. Biol. <a href="https://doi.org/10.1016/j.tpb.2019.11.005" class="uri">https://doi.org/10.1016/j.tpb.2019.11.005</a></p>
</div>
<div id="used-r-packages" class="section level1">
<h1 class="hasAnchor">
<a href="#used-r-packages" class="anchor"></a>Used R-packages</h1>
<p>The PCMBase R-package uses the following 3rd party R-packages:</p>
<ul>
<li>For tree processing in R: ape v5.3 (Paradis et al. 2018), data.table v1.13.2 (Dowle and Srinivasan 2019);</li>
<li>For algebraic manipulation: expm v0.999.4 (Goulet et al. 2018), mvtnorm v1.1.0 (Genz et al. 2018);</li>
<li>For plotting: ggtree v2.0.4 (Yu and Lam 2019), ggplot2 v3.3.0 (Wickham et al. 2018);</li>
<li>For unit-testing: testthat v2.3.2 (Wickham 2018), covr v3.5.0 (Hester 2018);</li>
<li>For documentation and web-site generation: roxygen2 v7.1.0 (Wickham, Danenberg, and Eugster 2018), pkgdown v1.4.1 (Wickham and Hesselberth 2018);</li>
</ul>
</div>
<div id="licence-and-copyright" class="section level1">
<h1 class="hasAnchor">
<a href="#licence-and-copyright" class="anchor"></a>Licence and copyright</h1>
<p>Copyright 2016-2021 Venelin Mitov</p>
<p>Source code to PCMBase is made available under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version. PCMBase is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.</p>
</div>
<div id="references" class="section level1">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references">

<div id="ref-R-data-table">

Dowle, Matt, and Arun Srinivasan. 2019. *Data.table: Extension of
‘Data.frame‘*. <https:>.

</https:>
</div>

<div id="ref-R-mvtnorm">

Genz, Alan, Frank Bretz, Tetsuhisa Miwa, Xuefei Mi, and Torsten Hothorn.
2018. *Mvtnorm: Multivariate Normal and T Distributions*.
<https:>.

</https:>
</div>

<div id="ref-R-expm">

Goulet, Vincent, Christophe Dutang, Martin Maechler, David Firth, Marina
Shapira, and Michael Stadelmann. 2018. *Expm: Matrix Exponential, Log,
’Etc’*. <https:>.

</https:>
</div>

<div id="ref-R-covr">

Hester, Jim. 2018. *Covr: Test Coverage for Packages*.
<https:>.

</https:>
</div>

<div id="ref-Mitov:2019ci">

Mitov, Venelin, Krzysztof Bartoszek, and Tanja Stadler. 2019. “Automatic
generation of evolutionary hypotheses using mixed Gaussian phylogenetic
models.” *Proceedings of the National Academy of Sciences of the United
States of America* 35 (August): 201813823.

</div>

<div id="ref-R-ape">

Paradis, Emmanuel, Simon Blomberg, Ben Bolker, Joseph Brown, Julien
Claude, Hoa Sien Cuong, Richard Desper, et al. 2018. *Ape: Analyses of
Phylogenetics and Evolution*. <https:>.

</https:>
</div>

<div id="ref-R-testthat">

Wickham, Hadley. 2018. *Testthat: Unit Testing for R*.
<https:>.

</https:>
</div>

<div id="ref-R-ggplot2">

Wickham, Hadley, Winston Chang, Lionel Henry, Thomas Lin Pedersen,
Kohske Takahashi, Claus Wilke, and Kara Woo. 2018. *Ggplot2: Create
Elegant Data Visualisations Using the Grammar of Graphics*.
<https:>.

</https:>
</div>

<div id="ref-R-roxygen2">

Wickham, Hadley, Peter Danenberg, and Manuel Eugster. 2018. *Roxygen2:
In-Line Documentation for R*.
<https:>.

</https:>
</div>

<div id="ref-R-pkgdown">

Wickham, Hadley, and Jay Hesselberth. 2018. *Pkgdown: Make Static Html
Documentation for a Package*.
<https:>.

</https:>
</div>

<div id="ref-R-ggtree">

Yu, Guangchuang, and Tommy Tsan-Yuk Lam. 2019. *Ggtree: An R Package for
Visualization and Annotation of Phylogenetic Trees with Their Covariates
and Other Associated Data*.
<https:>.

</https:>
</div>

</div>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Download from CRAN at <br><a href="https://cloud.r-project.org/package=PCMBase">https://​cloud.r-project.org/​package=PCMBase</a>
</li>
<li>Report a bug at <br><a href="https://github.com/venelin/PCMBase/issues">https://​github.com/​venelin/​PCMBase/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>GPL (&gt;= 3.0)</li>
</ul>
</div>
<div class="citation">
<h2>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html">Citing PCMBase</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Venelin Mitov <br><small class="roles"> Author, maintainer, copyright holder </small>  <br><small>(<a href="https://venelin.github.io">venelin.github.io</a>)</small>
</li>
<li><a href="authors.html">All authors...</a></li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://travis-ci.com/venelin/PCMBase"><img src="https://travis-ci.com/venelin/PCMBase.svg?branch=master" alt="Travis build status"></a></li>
<li><a href="https://codecov.io/github/venelin/PCMBase?branch=master"><img src="https://codecov.io/gh/venelin/PCMBase/branch/master/graph/badge.svg" alt="Coverage status"></a></li>
<li><a href="https://cran.r-project.org/package=PCMBase"><img src="http://www.r-pkg.org/badges/version/PCMBase?color=blue" alt="CRAN_Status_Badge"></a></li>
<li><a href="https://cran.r-project.org/package=PCMBase"><img src="http://cranlogs.r-pkg.org/badges/PCMBase?color=blue" alt="Downloads"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Venelin Mitov.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
