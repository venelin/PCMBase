---
output: github_document
bibliography: vignettes/REFERENCES.bib
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, echo = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/"
)
```

[![Travis build status](https://travis-ci.org/venelin/PCMBase.svg?branch=master)](https://travis-ci.org/venelin/PCMBase)
[![Coverage status](https://codecov.io/gh/venelin/PCMBase/branch/master/graph/badge.svg)](https://codecov.io/github/venelin/PCMBase?branch=master)
[![CRAN_Status_Badge](http://www.r-pkg.org/badges/version/PCMBase?color=blue)](https://cran.r-project.org/package=PCMBase)
[![Downloads](http://cranlogs.r-pkg.org/badges/PCMBase?color=blue)](https://cran.r-project.org/package=PCMBase)
[![Latest release DOI](https://zenodo.org/badge/144310133.svg)](https://zenodo.org/badge/latestdoi/144310133)

# PCMBase : Simulation and likelihood calculation of phylogenetic comparative methods

Phylogenetic comparative methods represent models of continuous trait data associated with the tips of a phylogenetic tree. Examples of such models are Gaussian continuous time branching stochastic processes such as Brownian motion (BM) and Ornstein-Uhlenbeck (OU) processes, which regard the data at the tips of the tree as an observed (final) state of a Markov process starting from an initial state at the root and evolving along the branches of the tree. The PCMBase R package provides a general framework for manipulating such models. This framework consists of an application programming interface for specifying data and model parameters, and efficient algorithms for simulating trait evolution under a model and calculating the likelihood of model parameters for an assumed model and trait data. The package implements a growing collection of models, which currently includes BM, OU, BM/OU with jumps, two-speed OU as well as mixed Gaussian models, in which different types of the above models can be associated with different branches of the tree. The PCMBase package is limited to trait-simulation and likelihood calculation of (mixed) Gaussian phylogenetic models. The PCMFit package provides functionality for ML and Bayesian fit of these models to tree and trait data.

## Installation

### CRAN
```{r eval=FALSE}
install.packages("PCMBase")
```

### Github
```{r eval=FALSE}
devtools::install_github("venelin/PCMBase")
```

## Resources

The user guides and technical reference for the library are available from the [PCMBase web-page](https://venelin.github.io/PCMBase/). 

* The [Getting started](https://venelin.github.io/PCMBase/articles/PCMBase.html) 
* The [The PCMBase parameterizations](https://venelin.github.io/PCMBase/articles/PCMParam.html) (in preparation) 

The research article "Fast likelihood evaluation for multivariate phylogenetic comparative methods: the PCMBase R package" provides a general overview of PCMBase. The article is currently undergoing peer review for a publication and is available as a preprint from [arxiv](https://arxiv.org/abs/1809.09014).

The PCMBase source code is located in the [PCMBase github repository](https://github.com/venelin/PCMBase). 

Feature requests, bugs, etc can be reported in the [PCMBase issues list](https://github.com/venelin/PCMBase/issues).

# Citing PCMBase

To give credit to the PCMBase package in a publication, please cite the following article:

Mitov, V., Bartoszek, K., Asimomitis, G., & Stadler, T. (2018, September 24). Fast likelihood evaluation for multivariate phylogenetic comparative methods: the PCMBase R package. arXiv.org. https://arxiv.org/abs/1809.09014.

# Used R-packages
```{r create-references, echo=FALSE, include=FALSE, eval=TRUE}
treeProcessing <- c("ape", "data.table")
maths <- c("expm", "mvtnorm")
plots <- c("ggtree", "ggplot2")
testing <- c("testthat", "covr")
docs <- c("roxygen2", "pkgdown")

packagesUsed <- c(treeProcessing, maths, plots, testing, docs)

printPackages <- function(packs) {
  res <- ""
  for(i in 1:length(packs)) {
    res <- paste0(res, paste0(packs[i], ' v', packageVersion(packs[i]), ' [@R-', packs[i], ']'))
    if(i < length(packs)) {
      res <- paste0(res, ', ')
    }
  }
  res
}

# Write bib information (this line is executed manually and the bib-file is edited manually after that)
knitr::write_bib(packagesUsed, file = "./vignettes/REFERENCES-R.bib")
```

The PCMBase R-package uses the following 3rd party R-packages:

* For tree processing in R: `r printPackages(treeProcessing)`;
* For algebraic manipulation: `r printPackages(maths)`;
* For plotting: `r printPackages(plots)`;
* For unit-testing: `r printPackages(testing)`;
* For documentation and web-site generation: `r printPackages(docs)`;

# References

